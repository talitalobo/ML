{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "** Linear Regression Implementation **\n",
    "\n",
    "----\n",
    "\n",
    "Original code by Siraj Raval https://github.com/llSourcell/linear_regression_live"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Running...\n",
      "SSE :  103.398422917\n",
      "Equation: y =  3.2621822676 x +  -0.182342553765\n"
     ]
    }
   ],
   "source": [
    "from numpy import *\n",
    "\n",
    "# Coding linear regression from scratch to exaplain gradiend descent\n",
    "\n",
    "def compute_error_for_points(b, m, points):\n",
    "    # error, loss\n",
    "    # sum of the squared errors sse\n",
    "    \n",
    "    totalError = 0\n",
    "    for i in range(0, len(points)):\n",
    "        x = points[i, 0]\n",
    "        y = points[i, 1]\n",
    "        totalError += (y - (m * x + b)) **2\n",
    "        \n",
    "    averageError = totalError/float(len(points))\n",
    "    return averageError\n",
    "\n",
    "    \n",
    "def step_gradient(b_current, m_current, points, learning_rate):\n",
    "    # how gradient descent works\n",
    "    b_gradient = 0\n",
    "    m_gradient = 0\n",
    "    N = float(len(points))\n",
    "    \n",
    "    for i in range(0, len(points)):\n",
    "        x = points[i,0]\n",
    "        y = points[i,1]\n",
    "        \n",
    "        b_gradient += -(2/N) * (y - ((m_current * x) + b_current))\n",
    "        m_gradient += -(2/N) * x * (y - ((m_current * x) + b_current))\n",
    "        \n",
    "    new_b = b_current - (learning_rate * b_gradient)\n",
    "    new_m = m_current - (learning_rate * m_gradient)\n",
    "    \n",
    "    return [new_b, new_m]\n",
    "\n",
    "\n",
    "def gradient_descent_runner(points, starting_b, starting_m, learning_rate, iterations):\n",
    "    b = starting_b\n",
    "    m = starting_m\n",
    "    \n",
    "    for i in range(iterations):\n",
    "        b,m = step_gradient(b, m, array(points), learning_rate)\n",
    "    return [b,m]\n",
    "\n",
    "\n",
    "def run():\n",
    "    points = genfromtxt('income.csv', delimiter = \",\")\n",
    "    \n",
    "    learning_rate = 0.0001 # how fast the model learns\n",
    "    initial_b = 0 # y = mx + b\n",
    "    initial_m = 0\n",
    "    iterations = 1000\n",
    "    \n",
    "    #print(\"Starting graient descent at b = {0}, m = {1}, error = {2}\".format(initial_b, initial_m, compute_error_for_line_given_points(initial_b, initial_m, points)))\n",
    "    print(\"Running...\")\n",
    "    \n",
    "    [b, m] = gradient_descent_runner(points, initial_b, initial_m, learning_rate, iterations)\n",
    "    \n",
    "    print(\"SSE : \", compute_error_for_points(b, m, points))\n",
    "    print(\"Equation: y = \", m, \"x + \", b)\n",
    "    \n",
    "    #print(\"After {0} iterations b = {1}, m = {2}, error = {3}\".format(num_iterations, b, m, compute_error_for_line_given_points(b, m, points)))\n",
    "\n",
    "if __name__ == \"__main__\":\n",
    "    run()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Answer the following questions**\n",
    "\n",
    "2. Modifique o código original para imprimir o RSS a cada iteração do gradiente descendente.\n",
    "\n",
    "3. O que acontece com o RSS ao longo das iterações (aumenta ou diminui) se você usar 1000 iterações e um learning_rate (tamanho do passo do gradiente) de 0.001? Por que você acha que isso acontece?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "RSS:  707.27101659\n",
      "RSS:  232.508779735\n",
      "RSS:  131.846692069\n",
      "RSS:  110.494831064\n",
      "RSS:  105.956950742\n",
      "RSS:  104.983681088\n",
      "RSS:  104.766120491\n",
      "RSS:  104.708774355\n",
      "RSS:  104.685396244\n",
      "RSS:  104.669221579\n",
      "RSS:  104.654576198\n",
      "RSS:  104.640257162\n",
      "RSS:  104.626009445\n",
      "RSS:  104.61177898\n",
      "RSS:  104.597554306\n",
      "RSS:  104.58333299\n",
      "RSS:  104.569114518\n",
      "RSS:  104.554898779\n",
      "RSS:  104.540685751\n",
      "RSS:  104.526475427\n",
      "RSS:  104.512267807\n",
      "RSS:  104.498062889\n",
      "RSS:  104.483860672\n",
      "RSS:  104.469661157\n",
      "RSS:  104.455464343\n",
      "RSS:  104.441270229\n",
      "RSS:  104.427078814\n",
      "RSS:  104.412890099\n",
      "RSS:  104.398704083\n",
      "RSS:  104.384520765\n",
      "RSS:  104.370340144\n",
      "RSS:  104.356162221\n",
      "RSS:  104.341986994\n",
      "RSS:  104.327814464\n",
      "RSS:  104.313644629\n",
      "RSS:  104.299477489\n",
      "RSS:  104.285313044\n",
      "RSS:  104.271151293\n",
      "RSS:  104.256992236\n",
      "RSS:  104.242835872\n",
      "RSS:  104.2286822\n",
      "RSS:  104.21453122\n",
      "RSS:  104.200382932\n",
      "RSS:  104.186237335\n",
      "RSS:  104.172094428\n",
      "RSS:  104.157954212\n",
      "RSS:  104.143816684\n",
      "RSS:  104.129681846\n",
      "RSS:  104.115549697\n",
      "RSS:  104.101420235\n",
      "RSS:  104.087293461\n",
      "RSS:  104.073169373\n",
      "RSS:  104.059047972\n",
      "RSS:  104.044929257\n",
      "RSS:  104.030813228\n",
      "RSS:  104.016699883\n",
      "RSS:  104.002589223\n",
      "RSS:  103.988481246\n",
      "RSS:  103.974375953\n",
      "RSS:  103.960273343\n",
      "RSS:  103.946173415\n",
      "RSS:  103.932076169\n",
      "RSS:  103.917981604\n",
      "RSS:  103.90388972\n",
      "RSS:  103.889800517\n",
      "RSS:  103.875713993\n",
      "RSS:  103.861630148\n",
      "RSS:  103.847548982\n",
      "RSS:  103.833470495\n",
      "RSS:  103.819394685\n",
      "RSS:  103.805321553\n",
      "RSS:  103.791251097\n",
      "RSS:  103.777183317\n",
      "RSS:  103.763118213\n",
      "RSS:  103.749055785\n",
      "RSS:  103.734996031\n",
      "RSS:  103.720938951\n",
      "RSS:  103.706884545\n",
      "RSS:  103.692832812\n",
      "RSS:  103.678783752\n",
      "RSS:  103.664737364\n",
      "RSS:  103.650693647\n",
      "RSS:  103.636652602\n",
      "RSS:  103.622614227\n",
      "RSS:  103.608578523\n",
      "RSS:  103.594545488\n",
      "RSS:  103.580515122\n",
      "RSS:  103.566487424\n",
      "RSS:  103.552462395\n",
      "RSS:  103.538440034\n",
      "RSS:  103.524420339\n",
      "RSS:  103.510403311\n",
      "RSS:  103.496388949\n",
      "RSS:  103.482377253\n",
      "RSS:  103.468368222\n",
      "RSS:  103.454361855\n",
      "RSS:  103.440358153\n",
      "RSS:  103.426357113\n",
      "RSS:  103.412358737\n",
      "RSS:  103.398363024\n",
      "RSS:  103.384369972\n",
      "RSS:  103.370379582\n",
      "RSS:  103.356391853\n",
      "RSS:  103.342406784\n",
      "RSS:  103.328424376\n",
      "RSS:  103.314444626\n",
      "RSS:  103.300467536\n",
      "RSS:  103.286493104\n",
      "RSS:  103.272521331\n",
      "RSS:  103.258552214\n",
      "RSS:  103.244585755\n",
      "RSS:  103.230621952\n",
      "RSS:  103.216660805\n",
      "RSS:  103.202702314\n",
      "RSS:  103.188746477\n",
      "RSS:  103.174793295\n",
      "RSS:  103.160842767\n",
      "RSS:  103.146894892\n",
      "RSS:  103.13294967\n",
      "RSS:  103.1190071\n",
      "RSS:  103.105067183\n",
      "RSS:  103.091129916\n",
      "RSS:  103.077195301\n",
      "RSS:  103.063263336\n",
      "RSS:  103.049334021\n",
      "RSS:  103.035407355\n",
      "RSS:  103.021483338\n",
      "RSS:  103.00756197\n",
      "RSS:  102.993643249\n",
      "RSS:  102.979727176\n",
      "RSS:  102.96581375\n",
      "RSS:  102.95190297\n",
      "RSS:  102.937994836\n",
      "RSS:  102.924089347\n",
      "RSS:  102.910186503\n",
      "RSS:  102.896286303\n",
      "RSS:  102.882388747\n",
      "RSS:  102.868493835\n",
      "RSS:  102.854601565\n",
      "RSS:  102.840711938\n",
      "RSS:  102.826824953\n",
      "RSS:  102.812940609\n",
      "RSS:  102.799058905\n",
      "RSS:  102.785179842\n",
      "RSS:  102.771303419\n",
      "RSS:  102.757429635\n",
      "RSS:  102.74355849\n",
      "RSS:  102.729689984\n",
      "RSS:  102.715824115\n",
      "RSS:  102.701960883\n",
      "RSS:  102.688100288\n",
      "RSS:  102.67424233\n",
      "RSS:  102.660387007\n",
      "RSS:  102.64653432\n",
      "RSS:  102.632684268\n",
      "RSS:  102.618836849\n",
      "RSS:  102.604992065\n",
      "RSS:  102.591149914\n",
      "RSS:  102.577310395\n",
      "RSS:  102.563473509\n",
      "RSS:  102.549639255\n",
      "RSS:  102.535807632\n",
      "RSS:  102.52197864\n",
      "RSS:  102.508152278\n",
      "RSS:  102.494328546\n",
      "RSS:  102.480507444\n",
      "RSS:  102.46668897\n",
      "RSS:  102.452873124\n",
      "RSS:  102.439059906\n",
      "RSS:  102.425249316\n",
      "RSS:  102.411441352\n",
      "RSS:  102.397636014\n",
      "RSS:  102.383833303\n",
      "RSS:  102.370033216\n",
      "RSS:  102.356235755\n",
      "RSS:  102.342440918\n",
      "RSS:  102.328648704\n",
      "RSS:  102.314859114\n",
      "RSS:  102.301072147\n",
      "RSS:  102.287287802\n",
      "RSS:  102.273506078\n",
      "RSS:  102.259726976\n",
      "RSS:  102.245950495\n",
      "RSS:  102.232176635\n",
      "RSS:  102.218405394\n",
      "RSS:  102.204636772\n",
      "RSS:  102.190870769\n",
      "RSS:  102.177107384\n",
      "RSS:  102.163346618\n",
      "RSS:  102.149588468\n",
      "RSS:  102.135832936\n",
      "RSS:  102.122080019\n",
      "RSS:  102.108329719\n",
      "RSS:  102.094582034\n",
      "RSS:  102.080836964\n",
      "RSS:  102.067094508\n",
      "RSS:  102.053354666\n",
      "RSS:  102.039617437\n",
      "RSS:  102.025882821\n",
      "RSS:  102.012150817\n",
      "RSS:  101.998421426\n",
      "RSS:  101.984694645\n",
      "RSS:  101.970970476\n",
      "RSS:  101.957248917\n",
      "RSS:  101.943529967\n",
      "RSS:  101.929813627\n",
      "RSS:  101.916099896\n",
      "RSS:  101.902388774\n",
      "RSS:  101.888680259\n",
      "RSS:  101.874974352\n",
      "RSS:  101.861271051\n",
      "RSS:  101.847570357\n",
      "RSS:  101.833872269\n",
      "RSS:  101.820176786\n",
      "RSS:  101.806483908\n",
      "RSS:  101.792793634\n",
      "RSS:  101.779105965\n",
      "RSS:  101.765420899\n",
      "RSS:  101.751738435\n",
      "RSS:  101.738058574\n",
      "RSS:  101.724381316\n",
      "RSS:  101.710706658\n",
      "RSS:  101.697034602\n",
      "RSS:  101.683365145\n",
      "RSS:  101.669698289\n",
      "RSS:  101.656034033\n",
      "RSS:  101.642372375\n",
      "RSS:  101.628713316\n",
      "RSS:  101.615056854\n",
      "RSS:  101.601402991\n",
      "RSS:  101.587751724\n",
      "RSS:  101.574103054\n",
      "RSS:  101.560456979\n",
      "RSS:  101.546813501\n",
      "RSS:  101.533172617\n",
      "RSS:  101.519534328\n",
      "RSS:  101.505898632\n",
      "RSS:  101.492265531\n",
      "RSS:  101.478635022\n",
      "RSS:  101.465007106\n",
      "RSS:  101.451381782\n",
      "RSS:  101.437759049\n",
      "RSS:  101.424138908\n",
      "RSS:  101.410521357\n",
      "RSS:  101.396906396\n",
      "RSS:  101.383294025\n",
      "RSS:  101.369684243\n",
      "RSS:  101.356077049\n",
      "RSS:  101.342472444\n",
      "RSS:  101.328870426\n",
      "RSS:  101.315270996\n",
      "RSS:  101.301674152\n",
      "RSS:  101.288079894\n",
      "RSS:  101.274488222\n",
      "RSS:  101.260899135\n",
      "RSS:  101.247312632\n",
      "RSS:  101.233728714\n",
      "RSS:  101.220147379\n",
      "RSS:  101.206568628\n",
      "RSS:  101.192992459\n",
      "RSS:  101.179418873\n",
      "RSS:  101.165847868\n",
      "RSS:  101.152279445\n",
      "RSS:  101.138713602\n",
      "RSS:  101.12515034\n",
      "RSS:  101.111589657\n",
      "RSS:  101.098031553\n",
      "RSS:  101.084476029\n",
      "RSS:  101.070923082\n",
      "RSS:  101.057372714\n",
      "RSS:  101.043824922\n",
      "RSS:  101.030279708\n",
      "RSS:  101.01673707\n",
      "RSS:  101.003197007\n",
      "RSS:  100.98965952\n",
      "RSS:  100.976124608\n",
      "RSS:  100.96259227\n",
      "RSS:  100.949062507\n",
      "RSS:  100.935535316\n",
      "RSS:  100.922010698\n",
      "RSS:  100.908488653\n",
      "RSS:  100.89496918\n",
      "RSS:  100.881452278\n",
      "RSS:  100.867937947\n",
      "RSS:  100.854426186\n",
      "RSS:  100.840916996\n",
      "RSS:  100.827410375\n",
      "RSS:  100.813906323\n",
      "RSS:  100.800404839\n",
      "RSS:  100.786905924\n",
      "RSS:  100.773409576\n",
      "RSS:  100.759915794\n",
      "RSS:  100.74642458\n",
      "RSS:  100.732935931\n",
      "RSS:  100.719449849\n",
      "RSS:  100.705966331\n",
      "RSS:  100.692485378\n",
      "RSS:  100.679006988\n",
      "RSS:  100.665531163\n",
      "RSS:  100.652057901\n",
      "RSS:  100.638587201\n",
      "RSS:  100.625119063\n",
      "RSS:  100.611653487\n",
      "RSS:  100.598190472\n",
      "RSS:  100.584730018\n",
      "RSS:  100.571272125\n",
      "RSS:  100.55781679\n",
      "RSS:  100.544364015\n",
      "RSS:  100.530913799\n",
      "RSS:  100.517466141\n",
      "RSS:  100.504021041\n",
      "RSS:  100.490578498\n",
      "RSS:  100.477138512\n",
      "RSS:  100.463701082\n",
      "RSS:  100.450266208\n",
      "RSS:  100.43683389\n",
      "RSS:  100.423404126\n",
      "RSS:  100.409976916\n",
      "RSS:  100.396552261\n",
      "RSS:  100.383130159\n",
      "RSS:  100.36971061\n",
      "RSS:  100.356293613\n",
      "RSS:  100.342879168\n",
      "RSS:  100.329467274\n",
      "RSS:  100.316057932\n",
      "RSS:  100.30265114\n",
      "RSS:  100.289246898\n",
      "RSS:  100.275845205\n",
      "RSS:  100.262446062\n",
      "RSS:  100.249049467\n",
      "RSS:  100.23565542\n",
      "RSS:  100.222263921\n",
      "RSS:  100.208874969\n",
      "RSS:  100.195488563\n",
      "RSS:  100.182104704\n",
      "RSS:  100.16872339\n",
      "RSS:  100.155344621\n",
      "RSS:  100.141968397\n",
      "RSS:  100.128594717\n",
      "RSS:  100.115223581\n",
      "RSS:  100.101854988\n",
      "RSS:  100.088488938\n",
      "RSS:  100.07512543\n",
      "RSS:  100.061764463\n",
      "RSS:  100.048406039\n",
      "RSS:  100.035050154\n",
      "RSS:  100.021696811\n",
      "RSS:  100.008346006\n",
      "RSS:  99.9949977418\n",
      "RSS:  99.981652016\n",
      "RSS:  99.9683088286\n",
      "RSS:  99.9549681791\n",
      "RSS:  99.9416300669\n",
      "RSS:  99.9282944918\n",
      "RSS:  99.914961453\n",
      "RSS:  99.9016309503\n",
      "RSS:  99.888302983\n",
      "RSS:  99.8749775507\n",
      "RSS:  99.8616546529\n",
      "RSS:  99.8483342892\n",
      "RSS:  99.835016459\n",
      "RSS:  99.8217011619\n",
      "RSS:  99.8083883974\n",
      "RSS:  99.795078165\n",
      "RSS:  99.7817704643\n",
      "RSS:  99.7684652946\n",
      "RSS:  99.7551626557\n",
      "RSS:  99.7418625469\n",
      "RSS:  99.7285649679\n",
      "RSS:  99.715269918\n",
      "RSS:  99.7019773969\n",
      "RSS:  99.6886874041\n",
      "RSS:  99.675399939\n",
      "RSS:  99.6621150012\n",
      "RSS:  99.6488325903\n",
      "RSS:  99.6355527057\n",
      "RSS:  99.6222753469\n",
      "RSS:  99.6090005135\n",
      "RSS:  99.5957282051\n",
      "RSS:  99.582458421\n",
      "RSS:  99.5691911609\n",
      "RSS:  99.5559264242\n",
      "RSS:  99.5426642105\n",
      "RSS:  99.5294045193\n",
      "RSS:  99.5161473501\n",
      "RSS:  99.5028927024\n",
      "RSS:  99.4896405758\n",
      "RSS:  99.4763909698\n",
      "RSS:  99.4631438839\n",
      "RSS:  99.4498993176\n",
      "RSS:  99.4366572704\n",
      "RSS:  99.4234177419\n",
      "RSS:  99.4101807316\n",
      "RSS:  99.3969462389\n",
      "RSS:  99.3837142635\n",
      "RSS:  99.3704848049\n",
      "RSS:  99.3572578625\n",
      "RSS:  99.3440334359\n",
      "RSS:  99.3308115246\n",
      "RSS:  99.3175921281\n",
      "RSS:  99.304375246\n",
      "RSS:  99.2911608777\n",
      "RSS:  99.2779490229\n",
      "RSS:  99.264739681\n",
      "RSS:  99.2515328515\n",
      "RSS:  99.2383285339\n",
      "RSS:  99.2251267279\n",
      "RSS:  99.2119274328\n",
      "RSS:  99.1987306483\n",
      "RSS:  99.1855363739\n",
      "RSS:  99.172344609\n",
      "RSS:  99.1591553532\n",
      "RSS:  99.145968606\n",
      "RSS:  99.132784367\n",
      "RSS:  99.1196026356\n",
      "RSS:  99.1064234114\n",
      "RSS:  99.0932466939\n",
      "RSS:  99.0800724827\n",
      "RSS:  99.0669007772\n",
      "RSS:  99.053731577\n",
      "RSS:  99.0405648816\n",
      "RSS:  99.0274006905\n",
      "RSS:  99.0142390033\n",
      "RSS:  99.0010798195\n",
      "RSS:  98.9879231385\n",
      "RSS:  98.97476896\n",
      "RSS:  98.9616172834\n",
      "RSS:  98.9484681083\n",
      "RSS:  98.9353214342\n",
      "RSS:  98.9221772606\n",
      "RSS:  98.9090355871\n",
      "RSS:  98.8958964131\n",
      "RSS:  98.8827597382\n",
      "RSS:  98.869625562\n",
      "RSS:  98.8564938838\n",
      "RSS:  98.8433647034\n",
      "RSS:  98.8302380201\n",
      "RSS:  98.8171138336\n",
      "RSS:  98.8039921433\n",
      "RSS:  98.7908729487\n",
      "RSS:  98.7777562495\n",
      "RSS:  98.7646420451\n",
      "RSS:  98.751530335\n",
      "RSS:  98.7384211188\n",
      "RSS:  98.7253143959\n",
      "RSS:  98.712210166\n",
      "RSS:  98.6991084286\n",
      "RSS:  98.6860091831\n",
      "RSS:  98.6729124291\n",
      "RSS:  98.6598181662\n",
      "RSS:  98.6467263938\n",
      "RSS:  98.6336371115\n",
      "RSS:  98.6205503187\n",
      "RSS:  98.6074660151\n",
      "RSS:  98.5943842002\n",
      "RSS:  98.5813048734\n",
      "RSS:  98.5682280344\n",
      "RSS:  98.5551536826\n",
      "RSS:  98.5420818176\n",
      "RSS:  98.5290124388\n",
      "RSS:  98.5159455459\n",
      "RSS:  98.5028811383\n",
      "RSS:  98.4898192156\n",
      "RSS:  98.4767597772\n",
      "RSS:  98.4637028229\n",
      "RSS:  98.4506483519\n",
      "RSS:  98.437596364\n",
      "RSS:  98.4245468585\n",
      "RSS:  98.4114998351\n",
      "RSS:  98.3984552933\n",
      "RSS:  98.3854132325\n",
      "RSS:  98.3723736524\n",
      "RSS:  98.3593365524\n",
      "RSS:  98.3463019321\n",
      "RSS:  98.333269791\n",
      "RSS:  98.3202401287\n",
      "RSS:  98.3072129446\n",
      "RSS:  98.2941882383\n",
      "RSS:  98.2811660093\n",
      "RSS:  98.2681462572\n",
      "RSS:  98.2551289815\n",
      "RSS:  98.2421141816\n",
      "RSS:  98.2291018572\n",
      "RSS:  98.2160920078\n",
      "RSS:  98.2030846328\n",
      "RSS:  98.1900797319\n",
      "RSS:  98.1770773046\n",
      "RSS:  98.1640773503\n",
      "RSS:  98.1510798686\n",
      "RSS:  98.1380848591\n",
      "RSS:  98.1250923212\n",
      "RSS:  98.1121022546\n",
      "RSS:  98.0991146587\n",
      "RSS:  98.086129533\n",
      "RSS:  98.0731468772\n",
      "RSS:  98.0601666906\n",
      "RSS:  98.0471889729\n",
      "RSS:  98.0342137236\n",
      "RSS:  98.0212409422\n",
      "RSS:  98.0082706283\n",
      "RSS:  97.9953027813\n",
      "RSS:  97.9823374009\n",
      "RSS:  97.9693744865\n",
      "RSS:  97.9564140376\n",
      "RSS:  97.9434560538\n",
      "RSS:  97.9305005347\n",
      "RSS:  97.9175474798\n",
      "RSS:  97.9045968885\n",
      "RSS:  97.8916487604\n",
      "RSS:  97.8787030952\n",
      "RSS:  97.8657598922\n",
      "RSS:  97.852819151\n",
      "RSS:  97.8398808711\n",
      "RSS:  97.8269450522\n",
      "RSS:  97.8140116936\n",
      "RSS:  97.8010807951\n",
      "RSS:  97.7881523559\n",
      "RSS:  97.7752263758\n",
      "RSS:  97.7623028543\n",
      "RSS:  97.7493817908\n",
      "RSS:  97.7364631849\n",
      "RSS:  97.7235470362\n",
      "RSS:  97.7106333441\n",
      "RSS:  97.6977221083\n",
      "RSS:  97.6848133282\n",
      "RSS:  97.6719070033\n",
      "RSS:  97.6590031333\n",
      "RSS:  97.6461017176\n",
      "RSS:  97.6332027558\n",
      "RSS:  97.6203062473\n",
      "RSS:  97.6074121919\n",
      "RSS:  97.5945205888\n",
      "RSS:  97.5816314378\n",
      "RSS:  97.5687447383\n",
      "RSS:  97.5558604899\n",
      "RSS:  97.5429786921\n",
      "RSS:  97.5300993445\n",
      "RSS:  97.5172224465\n",
      "RSS:  97.5043479977\n",
      "RSS:  97.4914759977\n",
      "RSS:  97.4786064459\n",
      "RSS:  97.465739342\n",
      "RSS:  97.4528746854\n",
      "RSS:  97.4400124757\n",
      "RSS:  97.4271527124\n",
      "RSS:  97.414295395\n",
      "RSS:  97.4014405231\n",
      "RSS:  97.3885880963\n",
      "RSS:  97.375738114\n",
      "RSS:  97.3628905757\n",
      "RSS:  97.3500454812\n",
      "RSS:  97.3372028297\n",
      "RSS:  97.324362621\n",
      "RSS:  97.3115248545\n",
      "RSS:  97.2986895297\n",
      "RSS:  97.2858566463\n",
      "RSS:  97.2730262037\n",
      "RSS:  97.2601982014\n",
      "RSS:  97.2473726391\n",
      "RSS:  97.2345495162\n",
      "RSS:  97.2217288323\n",
      "RSS:  97.2089105869\n",
      "RSS:  97.1960947796\n",
      "RSS:  97.1832814098\n",
      "RSS:  97.1704704772\n",
      "RSS:  97.1576619812\n",
      "RSS:  97.1448559214\n",
      "RSS:  97.1320522974\n",
      "RSS:  97.1192511086\n",
      "RSS:  97.1064523547\n",
      "RSS:  97.0936560351\n",
      "RSS:  97.0808621493\n",
      "RSS:  97.068070697\n",
      "RSS:  97.0552816777\n",
      "RSS:  97.0424950908\n",
      "RSS:  97.029710936\n",
      "RSS:  97.0169292127\n",
      "RSS:  97.0041499205\n",
      "RSS:  96.991373059\n",
      "RSS:  96.9785986277\n",
      "RSS:  96.9658266261\n",
      "RSS:  96.9530570537\n",
      "RSS:  96.9402899101\n",
      "RSS:  96.9275251949\n",
      "RSS:  96.9147629075\n",
      "RSS:  96.9020030476\n",
      "RSS:  96.8892456146\n",
      "RSS:  96.8764906081\n",
      "RSS:  96.8637380275\n",
      "RSS:  96.8509878726\n",
      "RSS:  96.8382401428\n",
      "RSS:  96.8254948376\n",
      "RSS:  96.8127519566\n",
      "RSS:  96.8000114993\n",
      "RSS:  96.7872734652\n",
      "RSS:  96.774537854\n",
      "RSS:  96.761804665\n",
      "RSS:  96.749073898\n",
      "RSS:  96.7363455524\n",
      "RSS:  96.7236196277\n",
      "RSS:  96.7108961235\n",
      "RSS:  96.6981750394\n",
      "RSS:  96.6854563748\n",
      "RSS:  96.6727401293\n",
      "RSS:  96.6600263025\n",
      "RSS:  96.6473148939\n",
      "RSS:  96.634605903\n",
      "RSS:  96.6218993293\n",
      "RSS:  96.6091951725\n",
      "RSS:  96.5964934321\n",
      "RSS:  96.5837941075\n",
      "RSS:  96.5710971984\n",
      "RSS:  96.5584027042\n",
      "RSS:  96.5457106246\n",
      "RSS:  96.533020959\n",
      "RSS:  96.520333707\n",
      "RSS:  96.5076488681\n",
      "RSS:  96.4949664419\n",
      "RSS:  96.482286428\n",
      "RSS:  96.4696088258\n",
      "RSS:  96.4569336349\n",
      "RSS:  96.4442608548\n",
      "RSS:  96.4315904851\n",
      "RSS:  96.4189225254\n",
      "RSS:  96.4062569751\n",
      "RSS:  96.3935938338\n",
      "RSS:  96.3809331011\n",
      "RSS:  96.3682747765\n",
      "RSS:  96.3556188595\n",
      "RSS:  96.3429653497\n",
      "RSS:  96.3303142466\n",
      "RSS:  96.3176655497\n",
      "RSS:  96.3050192587\n",
      "RSS:  96.292375373\n",
      "RSS:  96.2797338922\n",
      "RSS:  96.2670948158\n",
      "RSS:  96.2544581434\n",
      "RSS:  96.2418238746\n",
      "RSS:  96.2291920087\n",
      "RSS:  96.2165625455\n",
      "RSS:  96.2039354844\n",
      "RSS:  96.1913108251\n",
      "RSS:  96.1786885669\n",
      "RSS:  96.1660687095\n",
      "RSS:  96.1534512525\n",
      "RSS:  96.1408361953\n",
      "RSS:  96.1282235375\n",
      "RSS:  96.1156132786\n",
      "RSS:  96.1030054183\n",
      "RSS:  96.090399956\n",
      "RSS:  96.0777968912\n",
      "RSS:  96.0651962236\n",
      "RSS:  96.0525979527\n",
      "RSS:  96.0400020779\n",
      "RSS:  96.027408599\n",
      "RSS:  96.0148175153\n",
      "RSS:  96.0022288265\n",
      "RSS:  95.989642532\n",
      "RSS:  95.9770586315\n",
      "RSS:  95.9644771245\n",
      "RSS:  95.9518980105\n",
      "RSS:  95.939321289\n",
      "RSS:  95.9267469597\n",
      "RSS:  95.9141750221\n",
      "RSS:  95.9016054756\n",
      "RSS:  95.8890383199\n",
      "RSS:  95.8764735545\n",
      "RSS:  95.8639111789\n",
      "RSS:  95.8513511927\n",
      "RSS:  95.8387935955\n",
      "RSS:  95.8262383867\n",
      "RSS:  95.8136855659\n",
      "RSS:  95.8011351327\n",
      "RSS:  95.7885870866\n",
      "RSS:  95.7760414272\n",
      "RSS:  95.763498154\n",
      "RSS:  95.7509572665\n",
      "RSS:  95.7384187644\n",
      "RSS:  95.7258826471\n",
      "RSS:  95.7133489141\n",
      "RSS:  95.7008175651\n",
      "RSS:  95.6882885996\n",
      "RSS:  95.6757620171\n",
      "RSS:  95.6632378172\n",
      "RSS:  95.6507159995\n",
      "RSS:  95.6381965634\n",
      "RSS:  95.6256795085\n",
      "RSS:  95.6131648343\n",
      "RSS:  95.6006525405\n",
      "RSS:  95.5881426266\n",
      "RSS:  95.575635092\n",
      "RSS:  95.5631299364\n",
      "RSS:  95.5506271593\n",
      "RSS:  95.5381267603\n",
      "RSS:  95.5256287388\n",
      "RSS:  95.5131330945\n",
      "RSS:  95.5006398269\n",
      "RSS:  95.4881489356\n",
      "RSS:  95.47566042\n",
      "RSS:  95.4631742798\n",
      "RSS:  95.4506905144\n",
      "RSS:  95.4382091235\n",
      "RSS:  95.4257301065\n",
      "RSS:  95.4132534631\n",
      "RSS:  95.4007791928\n",
      "RSS:  95.3883072951\n",
      "RSS:  95.3758377695\n",
      "RSS:  95.3633706157\n",
      "RSS:  95.3509058332\n",
      "RSS:  95.3384434215\n",
      "RSS:  95.3259833802\n",
      "RSS:  95.3135257087\n",
      "RSS:  95.3010704068\n",
      "RSS:  95.2886174739\n",
      "RSS:  95.2761669095\n",
      "RSS:  95.2637187133\n",
      "RSS:  95.2512728847\n",
      "RSS:  95.2388294233\n",
      "RSS:  95.2263883287\n",
      "RSS:  95.2139496005\n",
      "RSS:  95.2015132381\n",
      "RSS:  95.1890792411\n",
      "RSS:  95.1766476091\n",
      "RSS:  95.1642183416\n",
      "RSS:  95.1517914381\n",
      "RSS:  95.1393668983\n",
      "RSS:  95.1269447217\n",
      "RSS:  95.1145249077\n",
      "RSS:  95.1021074561\n",
      "RSS:  95.0896923662\n",
      "RSS:  95.0772796378\n",
      "RSS:  95.0648692702\n",
      "RSS:  95.0524612631\n",
      "RSS:  95.0400556161\n",
      "RSS:  95.0276523286\n",
      "RSS:  95.0152514003\n",
      "RSS:  95.0028528306\n",
      "RSS:  94.9904566192\n",
      "RSS:  94.9780627655\n",
      "RSS:  94.9656712692\n",
      "RSS:  94.9532821297\n",
      "RSS:  94.9408953467\n",
      "RSS:  94.9285109197\n",
      "RSS:  94.9161288482\n",
      "RSS:  94.9037491318\n",
      "RSS:  94.89137177\n",
      "RSS:  94.8789967625\n",
      "RSS:  94.8666241087\n",
      "RSS:  94.8542538082\n",
      "RSS:  94.8418858605\n",
      "RSS:  94.8295202652\n",
      "RSS:  94.8171570219\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "RSS:  94.8047961302\n",
      "RSS:  94.7924375894\n",
      "RSS:  94.7800813993\n",
      "RSS:  94.7677275594\n",
      "RSS:  94.7553760692\n",
      "RSS:  94.7430269282\n",
      "RSS:  94.7306801361\n",
      "RSS:  94.7183356924\n",
      "RSS:  94.7059935966\n",
      "RSS:  94.6936538482\n",
      "RSS:  94.681316447\n",
      "RSS:  94.6689813923\n",
      "RSS:  94.6566486837\n",
      "RSS:  94.6443183209\n",
      "RSS:  94.6319903033\n",
      "RSS:  94.6196646306\n",
      "RSS:  94.6073413022\n",
      "RSS:  94.5950203177\n",
      "RSS:  94.5827016767\n",
      "RSS:  94.5703853787\n",
      "RSS:  94.5580714233\n",
      "RSS:  94.54575981\n",
      "RSS:  94.5334505384\n",
      "RSS:  94.5211436081\n",
      "RSS:  94.5088390185\n",
      "RSS:  94.4965367694\n",
      "RSS:  94.4842368601\n",
      "RSS:  94.4719392903\n",
      "RSS:  94.4596440595\n",
      "RSS:  94.4473511673\n",
      "RSS:  94.4350606132\n",
      "RSS:  94.4227723968\n",
      "RSS:  94.4104865176\n",
      "RSS:  94.3982029752\n",
      "RSS:  94.3859217692\n",
      "RSS:  94.3736428991\n",
      "RSS:  94.3613663644\n",
      "RSS:  94.3490921648\n",
      "RSS:  94.3368202997\n",
      "RSS:  94.3245507688\n",
      "RSS:  94.3122835715\n",
      "RSS:  94.3000187075\n",
      "RSS:  94.2877561763\n",
      "RSS:  94.2754959775\n",
      "RSS:  94.2632381105\n",
      "RSS:  94.250982575\n",
      "RSS:  94.2387293706\n",
      "RSS:  94.2264784967\n",
      "RSS:  94.214229953\n",
      "RSS:  94.2019837389\n",
      "RSS:  94.1897398541\n",
      "RSS:  94.1774982981\n",
      "RSS:  94.1652590705\n",
      "RSS:  94.1530221708\n",
      "RSS:  94.1407875986\n",
      "RSS:  94.1285553534\n",
      "RSS:  94.1163254348\n",
      "RSS:  94.1040978424\n",
      "RSS:  94.0918725756\n",
      "RSS:  94.0796496342\n",
      "RSS:  94.0674290175\n",
      "RSS:  94.0552107253\n",
      "RSS:  94.042994757\n",
      "RSS:  94.0307811121\n",
      "RSS:  94.0185697904\n",
      "RSS:  94.0063607912\n",
      "RSS:  93.9941541142\n",
      "RSS:  93.981949759\n",
      "RSS:  93.969747725\n",
      "RSS:  93.9575480119\n",
      "RSS:  93.9453506192\n",
      "RSS:  93.9331555465\n",
      "RSS:  93.9209627932\n",
      "RSS:  93.9087723591\n",
      "RSS:  93.8965842436\n",
      "RSS:  93.8843984463\n",
      "RSS:  93.8722149668\n",
      "RSS:  93.8600338046\n",
      "RSS:  93.8478549592\n",
      "RSS:  93.8356784303\n",
      "RSS:  93.8235042174\n",
      "RSS:  93.8113323201\n",
      "RSS:  93.7991627378\n",
      "RSS:  93.7869954703\n",
      "RSS:  93.7748305169\n",
      "RSS:  93.7626678774\n",
      "RSS:  93.7505075512\n",
      "RSS:  93.738349538\n",
      "RSS:  93.7261938372\n",
      "RSS:  93.7140404484\n",
      "RSS:  93.7018893713\n",
      "RSS:  93.6897406052\n",
      "RSS:  93.67759415\n",
      "RSS:  93.6654500049\n",
      "RSS:  93.6533081698\n",
      "RSS:  93.641168644\n",
      "RSS:  93.6290314272\n",
      "RSS:  93.6168965189\n",
      "RSS:  93.6047639187\n",
      "RSS:  93.5926336261\n",
      "RSS:  93.5805056407\n",
      "RSS:  93.5683799621\n",
      "RSS:  93.5562565898\n",
      "RSS:  93.5441355234\n",
      "RSS:  93.5320167624\n",
      "RSS:  93.5199003065\n",
      "RSS:  93.5077861551\n",
      "RSS:  93.4956743079\n",
      "RSS:  93.4835647643\n",
      "RSS:  93.471457524\n",
      "RSS:  93.4593525865\n",
      "RSS:  93.4472499514\n",
      "RSS:  93.4351496183\n",
      "RSS:  93.4230515866\n",
      "RSS:  93.410955856\n",
      "RSS:  93.3988624261\n",
      "RSS:  93.3867712963\n",
      "RSS:  93.3746824663\n",
      "RSS:  93.3625959356\n",
      "RSS:  93.3505117038\n",
      "RSS:  93.3384297704\n",
      "RSS:  93.326350135\n",
      "RSS:  93.3142727972\n",
      "RSS:  93.3021977565\n",
      "RSS:  93.2901250125\n",
      "RSS:  93.2780545648\n",
      "RSS:  93.2659864129\n",
      "RSS:  93.2539205564\n",
      "RSS:  93.2418569948\n",
      "RSS:  93.2297957277\n",
      "RSS:  93.2177367547\n",
      "RSS:  93.2056800754\n",
      "RSS:  93.1936256892\n",
      "RSS:  93.1815735958\n",
      "RSS:  93.1695237947\n",
      "RSS:  93.1574762856\n",
      "RSS:  93.1454310678\n",
      "RSS:  93.1333881411\n",
      "RSS:  93.121347505\n",
      "RSS:  93.1093091591\n",
      "RSS:  93.0972731028\n",
      "RSS:  93.0852393358\n",
      "RSS:  93.0732078577\n",
      "RSS:  93.061178668\n",
      "RSS:  93.0491517662\n",
      "RSS:  93.037127152\n",
      "RSS:  93.0251048249\n",
      "RSS:  93.0130847845\n",
      "RSS:  93.0010670303\n",
      "RSS:  92.9890515618\n",
      "RSS:  92.9770383788\n",
      "RSS:  92.9650274807\n",
      "RSS:  92.953018867\n",
      "RSS:  92.9410125375\n",
      "RSS:  92.9290084915\n",
      "RSS:  92.9170067288\n",
      "RSS:  92.9050072487\n",
      "RSS:  92.8930100511\n",
      "RSS:  92.8810151353\n",
      "RSS:  92.8690225009\n",
      "RSS:  92.8570321476\n",
      "RSS:  92.8450440749\n",
      "RSS:  92.8330582823\n",
      "RSS:  92.8210747694\n",
      "RSS:  92.8090935358\n",
      "RSS:  92.7971145811\n",
      "RSS:  92.7851379048\n",
      "RSS:  92.7731635064\n",
      "RSS:  92.7611913857\n",
      "RSS:  92.749221542\n",
      "RSS:  92.737253975\n",
      "RSS:  92.7252886843\n",
      "RSS:  92.7133256694\n",
      "RSS:  92.7013649299\n",
      "RSS:  92.6894064653\n",
      "RSS:  92.6774502752\n",
      "RSS:  92.6654963593\n",
      "RSS:  92.653544717\n",
      "RSS:  92.6415953479\n",
      "RSS:  92.6296482516\n",
      "RSS:  92.6177034276\n",
      "RSS:  92.6057608756\n",
      "RSS:  92.5938205951\n",
      "RSS:  92.5818825857\n",
      "RSS:  92.5699468468\n",
      "RSS:  92.5580133782\n",
      "RSS:  92.5460821793\n",
      "RSS:  92.5341532498\n",
      "RSS:  92.5222265892\n",
      "RSS:  92.510302197\n",
      "RSS:  92.4983800729\n",
      "RSS:  92.4864602164\n",
      "RSS:  92.474542627\n",
      "RSS:  92.4626273045\n",
      "RSS:  92.4507142482\n",
      "RSS:  92.4388034578\n",
      "RSS:  92.4268949329\n",
      "RSS:  92.4149886729\n",
      "RSS:  92.4030846776\n",
      "RSS:  92.3911829465\n",
      "RSS:  92.379283479\n",
      "RSS:  92.3673862749\n",
      "RSS:  92.3554913336\n",
      "RSS:  92.3435986548\n",
      "RSS:  92.331708238\n",
      "RSS:  92.3198200827\n",
      "RSS:  92.3079341886\n",
      "RSS:  92.2960505552\n",
      "RSS:  92.2841691821\n",
      "RSS:  92.2722900689\n",
      "RSS:  92.2604132151\n",
      "RSS:  92.2485386203\n",
      "RSS:  92.236666284\n",
      "RSS:  92.2247962059\n",
      "RSS:  92.2129283855\n",
      "RSS:  92.2010628224\n",
      "RSS:  92.1891995161\n",
      "RSS:  92.1773384663\n",
      "RSS:  92.1654796724\n",
      "RSS:  92.1536231341\n",
      "RSS:  92.141768851\n",
      "RSS:  92.1299168225\n",
      "RSS:  92.1180670483\n",
      "RSS:  92.106219528\n",
      "RSS:  92.0943742611\n",
      "RSS:  92.0825312472\n",
      "RSS:  92.0706904858\n",
      "RSS:  92.0588519766\n",
      "RSS:  92.047015719\n",
      "RSS:  92.0351817128\n",
      "RSS:  92.0233499574\n",
      "RSS:  92.0115204524\n",
      "RSS:  91.9996931974\n",
      "RSS:  91.987868192\n",
      "RSS:  91.9760454357\n",
      "RSS:  91.9642249281\n",
      "RSS:  91.9524066688\n",
      "RSS:  91.9405906574\n",
      "RSS:  91.9287768933\n",
      "RSS:  91.9169653763\n",
      "RSS:  91.9051561059\n",
      "RSS:  91.8933490815\n",
      "RSS:  91.8815443029\n",
      "RSS:  91.8697417696\n",
      "RSS:  91.8579414812\n",
      "RSS:  91.8461434372\n",
      "RSS:  91.8343476372\n",
      "RSS:  91.8225540808\n",
      "SSE :  91.8225540808\n",
      "Equation: y =  3.453929781 x +  -3.40347631759\n"
     ]
    }
   ],
   "source": [
    "from numpy import *\n",
    "\n",
    "def compute_error_for_points(b, m, points):\n",
    "    # error, loss\n",
    "    # sum of the squared errors sse\n",
    "    \n",
    "    totalError = 0\n",
    "    for i in range(0, len(points)):\n",
    "        x = points[i, 0]\n",
    "        y = points[i, 1]\n",
    "        totalError += (y - (m * x + b)) **2\n",
    "        \n",
    "    averageError = totalError/float(len(points))\n",
    "    return averageError\n",
    "\n",
    "    \n",
    "def step_gradient(b_current, m_current, points, learning_rate):\n",
    "    # how gradient descent works\n",
    "    b_gradient = 0\n",
    "    m_gradient = 0\n",
    "    N = float(len(points))\n",
    "    \n",
    "    for i in range(0, len(points)):\n",
    "        x = points[i,0]\n",
    "        y = points[i,1]\n",
    "        \n",
    "        b_gradient += -(2/N) * (y - ((m_current * x) + b_current))\n",
    "        m_gradient += -(2/N) * x * (y - ((m_current * x) + b_current))\n",
    "        \n",
    "    new_b = b_current - (learning_rate * b_gradient)\n",
    "    new_m = m_current - (learning_rate * m_gradient)\n",
    "    \n",
    "    return [new_b, new_m]\n",
    "\n",
    "\n",
    "def gradient_descent_runner(points, starting_b, starting_m, learning_rate, iterations):\n",
    "    b = starting_b\n",
    "    m = starting_m\n",
    "    \n",
    "    for i in range(iterations):\n",
    "        b,m = step_gradient(b, m, array(points), learning_rate)\n",
    "        print(\"RSS: \", compute_error_for_points(b, m, points))\n",
    "    return [b,m]\n",
    "\n",
    "\n",
    "def run(learningRate, numIterations):\n",
    "    points = genfromtxt('income.csv', delimiter = \",\")\n",
    "    \n",
    "    learning_rate = learningRate \n",
    "    initial_b = 0 # y = mx + b\n",
    "    initial_m = 0\n",
    "    iterations = numIterations\n",
    "    \n",
    "    [b, m] = gradient_descent_runner(points, initial_b, initial_m, learning_rate, iterations)\n",
    "    \n",
    "    print(\"SSE : \", compute_error_for_points(b, m, points))\n",
    "    print(\"Equation: y = \", m, \"x + \", b)\n",
    "    \n",
    "\n",
    "if __name__ == \"__main__\":\n",
    "    run(0.001, 1000)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "4. Teste valores diferentes do número de iterações e learning_rate até que w0 e w1 sejam aproximadamente iguais a -39 e 5 respectivamente. Reporte os valores do número de iterações e learning_rate usados para atingir esses valores.\n",
    "\n",
    "5. O algoritmo do vídeo usa o número de iterações como critério de parada. Mude o algoritmo para considerar um critério de tolerância que é comparado ao tamanho do gradiente (como no algoritmo dos slides apresentados em sala).\n",
    "\n",
    "6. Ache um valor de tolerância que se aproxime dos valores dos parâmetros do item 4 acima. Que valor foi esse?"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.4.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
